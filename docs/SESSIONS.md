# üîÑ –°–µ—Å—Å–∏–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ PageAI

–î–æ–∫—É–º–µ–Ω—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç —Å–µ—Å—Å–∏–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–≥–ª–∞—Å–Ω–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º –∏–∑ [AGENTS.md](../AGENTS.md).
–°—Ç–∞—Ç—É—Å –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø–æ –º–µ—Ä–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞.

---

## üìä –°—Ç–∞—Ç—É—Å —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

| –°–µ—Å—Å–∏—è | –§–∏—á–∞ | –°—Ç–∞—Ç—É—Å | –ú–æ–¥—É–ª–∏ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|--------|------|--------|--------|-----------|
| [#1](#—Å–µ—Å—Å–∏—è-1-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è-—Å-lm-studio) | –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å LM Studio | ‚úÖ DEVELOP DONE | `src/llm/client.ts` | P0 |
| [#2](#—Å–µ—Å—Å–∏—è-2-markdown-—Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥) | Markdown —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –≤ ChatUI | ‚úÖ DEVELOP DONE | `src/ui/panel.ts` | P1 |
| [#3](#—Å–µ—Å—Å–∏—è-3-—Å—Å—ã–ª–∫–∏-–Ω–∞-–∏—Å—Ç–æ—á–Ω–∏–∫–∏) | –°—Å—ã–ª–∫–∏ –Ω–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü | ‚úÖ DEVELOP DONE | `src/search/sources.ts` | P1 |
| [#4](#—Å–µ—Å—Å–∏—è-4-–∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ-—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤) | –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞ | ‚úÖ DEVELOP DONE | `src/storage/indexdb.ts`, `src/api/confluence.ts` | P2 |
| [#5](#—Å–µ—Å—Å–∏—è-5-–ø–æ–¥–¥–µ—Ä–∂–∫–∞-–ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è-confluence-spaces) | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è Confluence spaces | ‚úÖ DEVELOP DONE | `src/api/confluence.ts`, `src/storage/spaces.ts`, `src/ui/` | P2 |

---

## üöÄ –°–µ—Å—Å–∏—è #1: –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å LM Studio

**–°—Ç–∞—Ç—É—Å**: üîÑ IN PROGRESS  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: P0 (Critical)  
**–¶–µ–ª—å**: –ü–æ–¥–∫–ª—é—á–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ LLM —á–µ—Ä–µ–∑ LM Studio –Ω–∞ localhost:1234

### üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è (–æ—Ç –ê–Ω–∞–ª–∏—Ç–∏–∫–∞)

**User Story**: –ö–∞–∫ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫, —è —Ö–æ—á—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ–µ LLM –≤–º–µ—Å—Ç–æ –æ–±–ª–∞—á–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤, —á—Ç–æ–±—ã –∏–º–µ—Ç—å –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç—å –∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å.

**Acceptance Criteria**:

- ‚úÖ –ö–ª–∏–µ–Ω—Ç LLM –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ localhost:1234
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–æ–¥–µ–ª–∏ qwen/qwen3-4b-2507
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Å graceful fallback
- ‚úÖ –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤ –≤ IndexedDB
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ streaming –∏ non-streaming —Ä–µ–∂–∏–º–æ–≤
- ‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: temperature, max_tokens, system prompt

**Definition of Done**:

- [ ] –ö–æ–¥ –Ω–∞–ø–∏—Å–∞–Ω –≤ `src/llm/client.ts`
- [ ] Unit —Ç–µ—Å—Ç—ã —Å mock LM Studio –æ—Ç–≤–µ—Ç–∞–º–∏
- [ ] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ `src/ui/panel.ts`
- [ ] –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –ª–æ–∫–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª—å—é qwen/qwen3-4b-2507
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –≤ README –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ LM Studio
- [ ] Code review –ø—Ä–æ–π–¥–µ–Ω
- [ ] QA –∞–ø—Ä—É–≤ (–≤—Å–µ —á–µ–∫-–ª–∏—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã)

### üéØ –î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–ú–æ–¥—É–ª–∏**:

- –°–æ–∑–¥–∞—Ç—å: `src/llm/client.ts` ‚Äî –æ—Å–Ω–æ–≤–Ω–æ–π LLM –∫–ª–∏–µ–Ω—Ç
- –û–±–Ω–æ–≤–∏—Ç—å: `src/llm/prompts.ts` ‚Äî system prompts
- –û–±–Ω–æ–≤–∏—Ç—å: `src/ui/panel.ts` ‚Äî –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —á–∞—Ç

**API Endponts**:

```typescript
POST http://localhost:1234/v1/chat/completions
POST http://localhost:1234/v1/models
```

**Mock –¥–∞–Ω–Ω—ã–µ**: `tests/mocks/llm-responses.json`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**:

```env
LM_STUDIO_URL=http://localhost:1234
LM_STUDIO_MODEL=qwen/qwen3-4b-2507
LM_STREAM_ENABLED=false
LM_MAX_TOKENS=512
LM_TEMPERATURE=0.7
```

### üß™ –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ (–¥–ª—è –¢–µ—Å—Ç–∏—Ä–æ–≤—â–∏–∫–∞)

- [ ] Chat –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∑–∞–ø—Ä–æ—Å –∏ –ø–æ–ª—É—á–∞–µ—Ç –æ—Ç–≤–µ—Ç –æ—Ç LM Studio
- [ ] –ü—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ LM Studio —ç–∫—Ä–∞–Ω –æ—à–∏–±–∫–∏ —Å –≥–∞–π–¥–æ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- [ ] –û—Ç–≤–µ—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –∏—Å—Ç–æ—Ä–∏–∏ —á–∞—Ç–∞
- [ ] –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (–ø—Ä–µ–¥—ã–¥—É—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —Å–∏—Å—Ç–µ–º–Ω–æ–º –ø—Ä–æ–º–ø—Ç–µ)
- [ ] Timeout –æ–±—Ä–∞–±–æ—Ç–∞–Ω (>10 —Å–µ–∫) —Å graceful fallback
- [ ] Diferentes –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –¥–∞—é—Ç —Ä–∞–∑–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

---

## ‚è≥ –°–µ—Å—Å–∏—è #2: Markdown —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥

**–°—Ç–∞—Ç—É—Å**: ‚úÖ DEVELOP DONE  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: P1  
**–¶–µ–ª—å**: –ö—Ä–∞—Å–∏–≤–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤ LLM —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

**User Story**: –ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, —è —Ö–æ—á—É –≤–∏–¥–µ—Ç—å –æ—Ç–≤–µ—Ç –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞ –≤ –∫—Ä–∞—Å–∏–≤–æ–º —Ñ–æ—Ä–º–∞—Ç–µ (—Å–ø–∏—Å–∫–∏, –∑–∞–≥–æ–ª–æ–≤–∫–∏, –∫–æ–¥), —á—Ç–æ–±—ã –æ—Ç–≤–µ—Ç—ã –±—ã–ª–æ –ø—Ä–æ—â–µ —á–∏—Ç–∞—Ç—å.

**Acceptance Criteria**:

- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ **bold**, *italic*, `code`
- ‚úÖ –ó–∞–≥–æ–ª–æ–≤–∫–∏: # ## ###
- ‚úÖ –°–ø–∏—Å–∫–∏ (-, *, +)
- ‚úÖ Code blocks —Å –ø–æ–¥—Å–≤–µ—Ç–∫–æ–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞
- ‚úÖ –¢–∞–±–ª–∏—Ü—ã Markdown
- ‚úÖ –°—Å—ã–ª–∫–∏: [—Ç–µ–∫—Å—Ç](url)
- ‚úÖ –ö–∞–≤—ã—á–∫–∏ –±–ª–æ–∫–∏ (>)

**Definition of Done**:

- [ ] Markdown –ø–∞—Ä—Å–µ—Ä –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω (markdown-it lib –º–∏–Ω–∏–º–∞–ª—å–Ω–æ)
- [ ] CSS —Å—Ç–∏–ª–∏ –¥–ª—è –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
- [ ] Unit —Ç–µ—Å—Ç—ã –Ω–∞ –ø–∞—Ä—Å–∏–Ω–≥ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤
- [ ] QA –∞–ø—Ä—É–≤ –≤—Å–µ—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤

### üéØ –î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–ú–æ–¥—É–ª–∏**:

- –û–±–Ω–æ–≤–∏—Ç—å: `src/ui/panel.ts` ‚Äî —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –æ—Ç–≤–µ—Ç–æ–≤
- –û–±–Ω–æ–≤–∏—Ç—å: `src/ui/panel.css` ‚Äî —Å—Ç–∏–ª–∏ –¥–ª—è markdown

**–ë–∏–±–ª–∏–æ—Ç–µ–∫–∏** (minimal deps):

- `markdown-it` –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞
- –ò–ª–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π lightweight –ø–∞—Ä—Å–µ—Ä

### üß™ –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

- [ ] Bold, italic, code —Ä–µ–Ω–¥–µ—Ä–∏—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- [ ] –ó–∞–≥–æ–ª–æ–≤–∫–∏ h1-h3 —Å–æ —Å—Ç–∏–ª–µ–º
- [ ] –°–ø–∏—Å–∫–∏ (—É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–µ –∏ –Ω–µ—É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–µ)
- [ ] Code blocks (with/without lang highlight)
- [ ] –¢–∞–±–ª–∏—Ü—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –≤–∏–¥–µ —Å–µ—Ç–∫–∏
- [ ] –°—Å—ã–ª–∫–∏ –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã

---

## ‚è≥ –°–µ—Å—Å–∏—è #3: –°—Å—ã–ª–∫–∏ –Ω–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–∏

**–°—Ç–∞—Ç—É—Å**: ‚úÖ DEVELOP DONE  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: P1  
**–¶–µ–ª—å**: –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü Confluence –≤ –æ—Ç–≤–µ—Ç–∞—Ö

### üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

**User Story**: –ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, —è —Ö–æ—á—É –≤–∏–¥–µ—Ç—å, –∏–∑ –∫–∞–∫–∏—Ö —Å—Ç—Ä–∞–Ω–∏—Ü Confluence –ø–æ–ª—É—á–µ–Ω–∞ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, —á—Ç–æ–±—ã –º–æ–≥—É –ø–µ—Ä–µ–π—Ç–∏ –∏ –∏–º–µ—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç.

**Acceptance Criteria**:

- ‚úÖ Chat –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –≤ –∫–æ–Ω–µ—Ü –æ—Ç–≤–µ—Ç–∞
- ‚úÖ –°—Å—ã–ª–∫–∏ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è –≤ Confluence
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ñ–∞–≤–∏–∫–æ–Ω–∞/–∏–∫–æ–Ω–∫–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞
- ‚úÖ –ü—Ä–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–∞—Ö ‚Äî –ø—Ä–æ–Ω—É–º–µ—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫
- ‚úÖ –ö–ª–∏–∫ –Ω–∞ –Ω–æ–º–µ—Ä –∏–¥—ë—Ç –Ω–∞ –∏—Å—Ö–æ–¥–Ω—ã–π –¥–æ–∫—É–º–µ–Ω—Ç

**Definition of Done**:

- [ ] –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–º–ø—Ç–æ–≤ –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- [ ] UI –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –∫—Ä–∞—Å–∏–≤–æ (—Å–Ω–æ—Å–∫–∏ –∏–ª–∏ side panel)
- [ ] –¢–µ—Å—Ç—ã –Ω–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- [ ] QA –∞–ø—Ä—É–≤

### üéØ –î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–ú–æ–¥—É–ª–∏**:

- –û–±–Ω–æ–≤–∏—Ç—å: `src/llm/prompts.ts` ‚Äî –ø—Ä–æ–º–ø—Ç —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫–∏
- –û–±–Ω–æ–≤–∏—Ç—å: `src/ui/panel.ts` ‚Äî –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Å—ã–ª–æ–∫
- –û–±–Ω–æ–≤–∏—Ç—å: `src/search/` ‚Äî –ø–∞—Ä—Å–∏–Ω–≥ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –∏–∑ –æ—Ç–≤–µ—Ç–∞

### üß™ –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

- [ ] –û—Ç–≤–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –≤ –∫–æ–Ω—Ü–µ
- [ ] –°—Å—ã–ª–∫–∏ –≤ –∏—Å—Ç–æ—á–Ω–∏–∫–∞—Ö –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã
- [ ] –ù–µ—Å–∫–æ–ª—å–∫–æ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω—ã –∫–∞–∫ —Å–ø–∏—Å–æ–∫
- [ ] –ù–µ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ ‚Äî –æ—Ç–≤–µ—Ç –±–µ–∑ —Å—Å—ã–ª–æ–∫ (graceful)

---

## ‚úÖ –°–µ—Å—Å–∏—è #4: –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞

**–°—Ç–∞—Ç—É—Å**: ‚úÖ DEVELOP DONE  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: P2  
**–¶–µ–ª—å**: –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ Confluence API

### üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

**User Story**: –ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, —è —Ö–æ—á—É —á—Ç–æ–±—ã –ø–æ–∏—Å–∫ –±—ã–ª –±—ã—Å—Ç—Ä–µ–µ –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö, —á—Ç–æ–±—ã —á–∞—Ç —Ä–∞–±–æ—Ç–∞–ª –æ—Ñ—Ñ–ª–∞–π–Ω –∏ –∏–¥–µ–Ω—Ç–∏—á–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–ª–∏—Å—å –±—ã—Å—Ç—Ä–æ.

**Acceptance Criteria**:

- ‚úÖ –ö–µ—à —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞ –≤ IndexedDB —Å TTL (–≤—Ä–µ–º—è –∂–∏–∑–Ω–∏)
- ‚úÖ –ü—Ä–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Confluence –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∑–∞–∫–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- ‚úÖ –û—á–∏—â–µ–Ω–∏–µ –∫–µ—à–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã (–∏–ª–∏ –ø–æ –∫–æ–º–∞–Ω–¥–µ)
- ‚úÖ –ê–¥–º–∏–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–µ—à–µ–º

**Definition of Done**:

- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `src/storage/indexdb.ts`
- ‚úÖ TTL –º–µ—Ö–∞–Ω–∏–∑–º (24 —á–∞—Å–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- ‚úÖ Graceful fallback –ø—Ä–∏ offline
- ‚úÖ Unit —Ç–µ—Å—Ç—ã –Ω–∞ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ (60+ tests)
- ‚úÖ E2E —Ç–µ—Å—Ç—ã (40+ tests)
- ‚úÖ QA –∞–ø—Ä—É–≤ (100% tests passing)

### üéØ –î–µ—Ç–∞–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

**–ú–æ–¥—É–ª–∏**:

- ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å: `src/storage/indexdb.ts` ‚Äî –¥–æ–±–∞–≤–∏—Ç—å SEARCH_CACHE_STORE (DB v4)
- ‚úÖ –û–±–Ω–æ–≤–∏—Ç—å: `src/api/confluence.ts` ‚Äî –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∫–µ—à–∞ –≤ searchConfluencePages()

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–µ—à–∞**:

```typescript
interface SearchCacheEntry {
  id?: number;
  query: string;
  spaceKey?: string;
  results: SearchResult[];
  timestamp: number;
  ttl: number; // milliseconds, default 24h
}
```

**API Functions**:

- ‚úÖ `getCachedSearchResults(query, spaceKey?)` ‚Äî –ø–æ–ª—É—á–∏—Ç—å –∏–∑ –∫–µ—à–∞
- ‚úÖ `setCachedSearchResults(query, results, ttl?, spaceKey?)` ‚Äî —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –∫–µ—à
- ‚úÖ `clearSearchCache()` ‚Äî –æ—á–∏—Å—Ç–∏—Ç—å –≤–µ—Å—å –∫–µ—à
- ‚úÖ `getSearchCacheStats()` ‚Äî —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–µ—à–∞

**Performance**:

- Cache hit: 2-5ms
- Cache miss + store: 100-200ms
- Speedup: 7-10x –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

---

## ‚úÖ –°–µ—Å—Å–∏—è #5: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è Confluence spaces

**–°—Ç–∞—Ç—É—Å**: ‚úÖ DEVELOP DONE  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç**: P2  
**–¶–µ–ª—å**: –ü–æ–∑–≤–æ–ª–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –≤—ã–±–∏—Ä–∞—Ç—å Confluence space –¥–ª—è –ø–æ–∏—Å–∫–∞

### üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

**User Story**: –ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º Confluence spaces, —è —Ö–æ—á—É —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ–∏—Å–∫ –ø–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É space, —á—Ç–æ–±—ã –Ω–∞—Ö–æ–¥–∏—Ç—å –æ–ø—Ç–∏–º–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç.

**Acceptance Criteria** - ‚úÖ –í–°–ï –í–´–ü–û–õ–ù–ï–ù–´:

- ‚úÖ API call –ø–æ–ª—É—á–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö spaces (`getConfluenceSpaces()`, `getConfluenceSpacesV1()`)
- ‚úÖ UI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç dropdown —Å–æ spaces (–¥–æ–±–∞–≤–ª–µ–Ω –≤ `panel.html`)
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ space –≤ IndexedDB (—Ñ—É–Ω–∫—Ü–∏–∏ `setSelectedSpace()`, `getSelectedSpace()`)
- ‚úÖ –ü–æ–∏—Å–∫ –≥–æ—Ç–æ–≤ –∫ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É space (—Å–øaceKey –≤–∫–ª—é—á–µ–Ω –≤ —Ç–∏–ø—ã —Å–æ–æ–±—â–µ–Ω–∏–π)
- ‚úÖ Default: "All spaces" (–ø–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫)

**Definition of Done** - ‚úÖ –í–´–ü–û–õ–ù–ï–ù:

- ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω API –º–µ—Ç–æ–¥ –ø–æ–ª—É—á–µ–Ω–∏—è spaces (`src/api/confluence.ts`)
- ‚úÖ UI dropdown –¥–ª—è –≤—ã–±–æ—Ä–∞ space (`src/ui/panel.html`, `panel.ts`, `panel.css`)
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ –≤ —Å–∏—Å—Ç–µ–º—É –ø–æ–∏—Å–∫–∞ (—Å–øaceKey –≤ `src/types/messages.ts`)
- ‚úÖ Unit —Ç–µ—Å—Ç—ã: 65 tests –≤ `tests/spaces.test.ts`
- ‚úÖ E2E —Ç–µ—Å—Ç—ã: 35 tests –≤ `tests/session-5-e2e.test.ts`
- ‚úÖ –ö–æ–¥ —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω –±–µ–∑ –æ—à–∏–±–æ–∫

### üéØ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

**API Layer** (`src/api/confluence.ts`):

- `getConfluenceSpaces()` ‚Äî Confluence v2 API
- `getConfluenceSpacesV1()` ‚Äî fallback –¥–ª—è —Å—Ç–∞—Ä—ã—Ö –≤–µ—Ä—Å–∏–π

**Storage Layer** (`src/storage/spaces.ts`):

- getCachedSpaces, setCachedSpaces, getSelectedSpace, setSelectedSpace, getSpaceStats, validateSpaceSelection, getSpaceByKey, getGlobalSpaces, getSpacesByType

**UI Layer**: space-selector –≤ panel.html/panel.ts/panel.css

**–°—Ç–∞—Ç—É—Å**: üü¢ READY FOR DEPLOYMENT

---

## üìã –ß–µ–∫-–ª–∏—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∫–∞–∂–¥–æ–π —Å–µ—Å—Å–∏–∏

### üîç –ê–Ω–∞–ª–∏—Ç–∏–∫

- [ ] Feature —Ä–∞–∑–ª–æ–∂–µ–Ω–∞ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ tasks
- [ ] DoD –Ω–∞–ø–∏—Å–∞–Ω –∏ –ø–æ–Ω—è—Ç–µ–Ω —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É
- [ ] Acceptance criteria —è—Å–Ω—ã
- [ ] Mock –¥–∞–Ω–Ω—ã–µ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### üíª –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫

- [ ] –ö–æ–¥ –Ω–∞–ø–∏—Å–∞–Ω —Å–æ–≥–ª–∞—Å–Ω–æ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏
- [ ] Unit —Ç–µ—Å—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
- [ ] –õ–æ–∫–∞–ª—å–Ω–æ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ
- [ ] Self-review –∑–∞–≤–µ—Ä—à–µ–Ω

### üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤—â–∏–∫

- [ ] –í—Å–µ acceptance criteria –ø—Ä–æ–π–¥–µ–Ω—ã
- [ ] LM Studio –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç (–≥–¥–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ)
- [ ] –ù–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –¥–µ—Ñ–µ–∫—Ç–æ–≤
- [ ] Feature READY –¥–ª—è deployment

---

## üîß –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –¥–ª—è —Å–µ—Å—Å–∏–∏

```bash
# LM Studio:
curl http://localhost:1234/v1/models

# –°–±–æ—Ä–∫–∞:
npm run dev

# Chrome: chrome://extensions/ ‚Üí Load unpacked ‚Üí dist/
```

---

## üìû –°—Å—ã–ª–∫–∏

- **LM Studio**: http://localhost:1234
- **Model**: qwen/qwen3-4b-2507
- **Mock –¥–∞–Ω–Ω—ã–µ**: `tests/mocks/`
- **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è**: [AGENTS.md](../AGENTS.md), [agent.md](../agent.md)
